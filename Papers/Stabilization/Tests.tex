In the following subsections we demonstrate the effectiveness of the the G2
method with cG(1)cG(1) finite elements when applied to the SWE. For each
numerical test we compare the cG(1)cG(1) discretization to the $P_1-P_1$
discretization with Crank-Nicholson time stepping scheme. The $P_1-P_1$ finite
element pair is known to produce spurious computational modes for the tests
given \cite{Le-Roux1998,Hanert2006}. Thus, any stable solutions in the following
similation are a result of the G2 cG(1)cG(1) discretization. In addition to the
stabilization we will observe the dispersivity of the cG(1)cG(1) discretization
in \autoref{sse:GravityWaves}. The dispersivity of a method is important when
considering long time integration, such as what would be seen in a OGCM
\cite{Le_Roux1998}.

\subsection{Test 1: High Frequency Elevation Modes} \label{sse:HFElevModes}
  In this subsection we perform the same numerical experiment as in Subsection
  6.1 of Hanert et al \cite{Hanert2002}, and Batteen and Han \cite{Batteen1981}
  in order to demonstrate the stability added by using the cG(1)cG(1) method
  presented in \autoref{sec:Discrete}. In both \cite{Hanert2002} and
  \cite{Batteen1981} they showed that certain FE element pairs, in the case of
  Hanert et al, or certain FD grids, in the case of Batteen and Han, resulted in
  spurious elevation modes by strongly forcing short wave modes. Thus, the
  following experiment demonstrates the effectiveness in eliminating spurious
  elevation modes.

  Following the numerical test in \cite{Hanert2002} and \cite{Batteen1981}, we
  solve the inviscid linear SWE equation, \eqref{eqn:SWE}, where the problem
  domain is a square with side length 1000 km with regular grid spacing of
  $\Delta x=50$ km, initial condition $\mathbf{u}_0 = 0$, and point mass source
  and sink of 1 m and -1 m at fixed locations in the middle of the domain,
  vertically, 500 km apart, horizontally, so as to force the flow.  The
  resulting solution are presented after 100 time steps. The numerical
  simulations were performed for both inertial ($R/\Delta x = 1/4$) and gravity
  wave ($R/\Delta x = 2$) limits, where $R$ is the Rossby radius of deformation
  is given by $R \equiv \sqrt{gH}/f$. Taking the the Coriolis parameter to be $f
  = 10^{-4}$ s$^{-1}$ then we have $H \approx 0.16$ m for the inertial limit and
  $H \approx 10$ m for the gravity wave limit. Choosing the time step to be
  $\Delta t = 100$ s for the inertial limit and $\Delta t = 800$ s for the
  gravity wave limit, results in nearly the same Gravitational Courant number,
  $C_g = \sqrt{gH}\,k/h$, \cite{Le-Roux1998}. To convert to the non-dimensional
  parameters, given in Equations \ref{eqn:Rossby}-\ref{eqn:Theta}, we take the
  characteristic velocity scale to be
  \begin{equation}
    U = \sqrt{g\,H_0}
    \label{eqn:VelocityScale}
  \end{equation}
  which gives 1.25 m/s for the inertial limit and 9.90 m/s for the gravity limit.
  Next we take the characteristic length scale to $L = 1000$ km, which gives a
  characteristic time scale for the inertial limit and gravity limit to be
  $T=800\,000$ s and $T=101\,010$ s, respectively. Additionally, we will take the
  average wave height to be $N=1$ m. Thus, the non-dimensional parameters are as
  follows: $Ro = 1.25\times10^{-2}$ for the inertial limit and
  $Ro=9.90\times10^{-2}$ for the gravity limit; $Fr = 1$ for both the inertial
  and gravity limits due to the choice in characteristic velocity;
  finally $\Theta = 6.25$ for the inertial limit while for the gravity limit
  $\Theta = 0.1$. A summary of all problem parameters can be seen in
  \autoref{tab:HFElevationParams}.

  \def\arraystretch{1.25} %add some more padding to the table
  \begin{table}[H]
    \begin{center}
      \begin{tabular}{|c|c|c|}
        \hline
        & $R/\Delta x = 1/4$ & $R/\Delta x = 2$ \\[0.1em] \hline \hline
        \multicolumn{3}{|c|}{Dimensional Parameters} \\ \hline
        $\Omega$ & \multicolumn{2}{c|}{$[0\text{ km}, 1000\text{ km}]^2$} \\ \hline
        $t$ & [0 s, 80\,000 s] & [0 s, 10\,000 s] \\ \hline
        $g$ & \multicolumn{2}{c|}{$9.8\text{ m/s}^2$} \\ \hline 
        $f$ & \multicolumn{2}{c|}{$10^{-4}\text{ s}^{-1}$} \\ \hline
        $H$ & 0.16 m & 10 m \\ \hline
        $\mathbf{u}_0(\mathbf{x})$ & \multicolumn{2}{c|}{0 m/s} \\ \hline
        $\eta_0(\mathbf{x})$ & \multicolumn{2}{c|}{0 m} \\ \hline
        $\mathbf{F}_1$ & \multicolumn{2}{c|}{ $\mathbf{0}\text{ m/s}^2$} \\ \hline
        $F_2$ & \multicolumn{2}{c|}{$
          \begin{cases} 
            1\text{ m} & \mathbf{x} = (250\text{ km}, 500\text{ km}) \\
            -1\text{ m} & \mathbf{x} = (750\text{ km}, 500\text{ km}) \\
            0\text{ m} & \text{otherwise}
          \end{cases}$} \\ \hline
        $\Delta t$ & 800 s & 100 s \\ \hline
        $\Delta x$ & \multicolumn{2}{c|}{50 km} \\ \hline \hline
        \multicolumn{3}{|c|}{Non-dimensional Parameters} \\ \hline
        $H$ & \multicolumn{2}{c|}{1} \\ \hline \hline
        $Ro$ & $1.25\times 10^{-2}$ & $9.90\times10^{-2}$ \\ \hline
        $Fr$ & \multicolumn{2}{c|}{1} \\ \hline
        $\Theta$ & 6.25 & 0.1 \\ \hline
        $k$ & \multicolumn{2}{c|}{0.01} \\ \hline
        $h$ & \multicolumn{2}{c|}{0.05} \\ \hline \hline
        $C_g$ & \multicolumn{2}{c|}{$\sim 20$} \\ \hline
      \end{tabular}
      \caption{Summary of Test 1 dimensional and non-dimensional parameters for
      both the gravity wave, $R/h = 2$, and inertial wave $R/h = 1/4$, limits.}
      \label{tab:HFElevationParams}
    \end{center}
  \end{table}

  As was noted in Hanert et al \cite{Hanert2002} the $P_1-P_1$ element, with no
  stabilization, results in a noisy elevation pattern when applied to this
  problem. %This can clearly be seen in \autoref{fig:P1P1HighFrequencyElevation}.
%  However, using the cG(1)cG(1) method results in a solution which is not noisy,
%  as can be seen in \autoref{fig:cG1cG1HighFrequencyElevation}.

\subsection{Test 2: High Frequency Velocity Modes}
  In this subsection we intend to show that the cG(1)cG(1) discretization of the
  SWE is stable in the velocity field. In \cite{Hanert2002} they showed that
  certain FE element pairs resulted in spurious elevation modes by strongly
  forcing short wave modes.  To demonstrate the effectiveness of the cG(1)cG(1)
  discretization at eliminating spurious velocity modes we perform the same
  numerical experiment as in Subsection 6.2 of Hanert et al \cite{Hanert2002},
  and Batteen and Han \cite{Batteen1981}

  For this numerical experiment we take many of the same parameters as we did
  for Test 1, except the mass source, $F_2$, is set to zero, the depth, $H$, is
  set to 2000 m, the initial velocity condition is zero except at the center
  where the magnitude of the velocity is set to 1 m/s, and the time step is set
  to 100 s.
  \def\arraystretch{1.25} %add some more padding to the table
  \begin{table}[H]
    \begin{center}
      \begin{tabular}{|c|c|}
        \hline
        $\Omega$ & $[0\text{ km}, 1000\text{ km}]^2$ \\ \hline
        $t$ &  \\ \hline
        $g$ & $9.8\text{ m/s}^2$ \\ \hline 
        $f$ & $10^{-4}\text{ s}^{-1}$ \\ \hline
        $H$ & 2000 m \\ \hline
        $\mathbf{u}_0(\mathbf{x})$ & 
          $\left|\mathbf{u}\right| = 
            \begin{cases}
              1\text{ m/s} & \text{if }\mathbf{x}=(500\text{ km}, 500\text{ km}) \\ 
              0\text{ m/s} & \text{otherwise}
            \end{cases}$ \\ \hline
          $\eta_0(\mathbf{x})$ & 0 m \\ \hline
        $\mathbf{F}_1$ & 0 m/s$^2$\\ \hline
        $F_2$ & 0 m\\ \hline
        $k$ & 100 s \\ \hline
        $h$ & 50 km \\ \hline
        $C_g$ & \textcolor{red}{Check}$\sim 0.5$ \\ \hline
      \end{tabular}
      \caption{Summary of Test 2 parameters.}
      \label{tab:HFVelocityParams}
    \end{center}
  \end{table}

\subsection{Test 4: Gravity Wave Propagation and Dispersion} \label{sse:GravityWaves}
  In this subsection we explore the same numerical experiment ``a'' in Le Roux
  et al \cite{Le-Roux1998}, where the propagation and dispersion of gravity
  waves are examined in a circular basin, $\Omega$. In this test the inviscid
  linear SWE \eqref{eqn:SWE} is solved for an initial Gaussian height field
  \begin{equation}
    \eta(\mathbf{x},0) := \alpha e^{-\beta \sqrt{x_1^2 + x_2^2}},
    \label{eqn:Guass}
  \end{equation}
  initial velocity $\mathbf{u}_0(\mathbf{x})=0$, and forcing function
  $\mathbf{F}:=\mathbf{0}$. Additionally, the Coriolis parameter is set to zero,
  thus the initial Gaussian should maintain its shape throughout the simulation.

  \def\arraystretch{1.25} %add some more padding to the table
  \begin{table}[H]
    \begin{center}
      \begin{tabular}{|c|c|}
        \hline
        $\Omega$ & $\sqrt{x^2 + y^2} \le 1000$ km \\ \hline
        $t$ &  \\ \hline
        $g$ & $9.8$ m/s$^2$ \\ \hline 
        $f$ & 0 s$^{-1}$ \\ \hline
        $H$ & 2000 m \\ \hline
        $\mathbf{u}_0(\mathbf{x})$ & $\mathbf{0}$ m/s \\ \hline
        $\eta_0(\mathbf{x})$ & $\eta(\mathbf{x},0) := \alpha e^{-\beta
          \sqrt{x_1^2 + x_2^2}}$ \\ \hline
        $\alpha$ & 100 m \\ \hline
        $\beta$ & $6.4\times10^{-11}$ m$^{-2}$ \\ \hline
        $\mathbf{F}_1$ & $\mathbf{0}$ \\ \hline
        $F_2$ & 0 \\ \hline
        $k$ & 80 s \\ \hline
        $h$ & $\sim 20$ km \\ \hline
        $C_g$ & \\ \hline
      \end{tabular}
      \caption{Summary of Test 4 parameters.}
      \label{tab:GravityWaveParams}
    \end{center}
  \end{table}
